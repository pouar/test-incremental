<!DOCTYPE html>
<head>
<title>Test incremental</title>

</head>

<body>
Your money: <output id="result"></output><br><br>

<button onclick="buy(0);">Buy Building A</button><br>
Cost of next one: <output id="costA"></output><br>
You own <output id="amountA"></output> Building A's!<br>
They make <output id="bonusA"></output> money per tick.<br>
<output id="canPay"></output><br><br>

<button onclick="buy(1);">Buy Building B</button><br>
Cost of next one: <output id="costB"></output><br>
You own <output id="amountB"></output> Building B's!<br>
They make <output id="bonusB"></output> money per tick.<br>
<output id="canPay"></output><br><br>

<button onclick="buy(2);">Buy Building C</button><br>
Cost of next one: <output id="costC"></output><br>
You own <output id="amountC"></output> Building C's!<br>
They make <output id="bonusC"></output> money per tick.<br>
<output id="canPay"></output><br><br>

<button onclick="buy(3);">Buy Building D</button><br>
Cost of next one: <output id="costD"></output><br>
You own <output id="amountD"></output> Building D's!<br>
They make <output id="bonusD"></output> money per tick.<br>
<output id="canPay"></output><br><br>



<script language="JavaScript">

var buyCost = 0;
var buyable = true;
var count;
var buildingModifier = 0;
var cost = 0;
var currentCost = [10, 25, 50, 100]
var building = [0, 0, 0, 0]
var money = 0;
var baseBonuses = [1, 2, 5, 10]
var currentBonuses = [0, 0, 0, 0]
var totalBonus = 0

var buildingA = 0;

function beginGame() {
    if(typeof(Worker) !== "undefined") {
        if(typeof(count) == "undefined") {
            count = new Worker("counterWorker.js");
        }
        count.onmessage = function(event) {
            document.getElementById("result").innerHTML = event.data;
            money = event.data
        };
    } else {
        document.getElementById("result").innerHTML = "Sorry, your browser does not support Web Workers...";
    }
}

function nlogn(n) {
    return n * Math.log10(n) * .9;
}

function checkBuyable() {
    if(cost <= money) {
        buyable = true;
    } else {
        buyable = false;
    }
}

var costA = document.createElement("costA")
var canPay = document.createElement("canPay")
var amountA = document.createElement("amountA")

function buy(buildingID) {
    cost = currentCost[buildingID];
    checkBuyable();
    if (buyable == true) {
        count.postMessage({action:'subtract', amount:currentCost[buildingID], once:true});
        currentCost[buildingID] = Math.ceil(nlogn(currentCost[buildingID]))
        building[buildingID] = building[buildingID] + 1
        document.getElementById("canPay").innerHTML = "You just bought another!"
        setTimeout(resetCanPay, 1000)
    } else {
        document.getElementById("canPay").innerHTML = "Too Expensive to buy another!"
        setTimeout(resetCanPay, 1000)
    }
    document.getElementById("costA").innerHTML = currentCost[0]
    document.getElementById("costB").innerHTML = currentCost[1]
    document.getElementById("costC").innerHTML = currentCost[2]
    document.getElementById("costD").innerHTML = currentCost[3]
    document.getElementById("amountA").innerHTML = building[0]
    document.getElementById("amountB").innerHTML = building[1]
    document.getElementById("amountC").innerHTML = building[2]
    document.getElementById("amountD").innerHTML = building[3]
    refreshBonuses();
}

function resetCanPay() {
    document.getElementById("canPay").innerHTML = " "
}

function resetBonuses() {
    totalBonus = 0
    for (i=0; i<= building.length; i++) {
        currentBonuses[i] = baseBonuses[i] * building[i]
        totalBonus = totalBonus + currentBonuses[i]
    }
}

document.getElementById("costA").innerHTML = currentCost[0]
document.getElementById("amountA").innerHTML = building[0]

beginGame();

</script>

</body>
